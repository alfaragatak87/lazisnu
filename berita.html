<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Berita â€” LAZISNU Pandanwangi 01</title>
  <link rel="stylesheet" href="css/style.css">

  <style>
    body{background:#f7fbf7}
    .berita-wrap{max-width:1100px;margin:30px auto;padding:20px}
    .section-title{font-size:26px;color:#19913d;margin-bottom:6px;}
    .section-sub{color:#666;font-size:14px;border-bottom:2px solid #e6f2e9;padding-bottom:10px;}

    .berita-grid{
      display:grid;
      grid-template-columns:repeat(3,1fr);
      gap:20px;
      margin-top:25px;
    }

    .berita-card{
      background:#fff;border-radius:14px;overflow:hidden;
      box-shadow:0 12px 30px rgba(0,0,0,.06);
      display:flex;flex-direction:column;
      transition:.3s;
    }

    .berita-card img{width:100%;height:180px;object-fit:cover;}

    .berita-body{padding:16px;display:flex;flex-direction:column;flex:1;}

    .berita-date{
      font-size:12px;background:#e6f7ec;color:#1e7a3a;
      display:inline-block;padding:4px 8px;border-radius:6px;
      margin-bottom:8px;font-weight:700;width:max-content;
    }

    .berita-body h3{margin:0 0 8px 0;color:#1e7a3a;font-size:17px;}
    .berita-body p{font-size:13px;color:#555;flex:1;}

    .btn-baca{
      margin-top:12px;background:#2fa05a;color:#fff;
      padding:10px;border-radius:10px;font-weight:700;
      font-size:13px;text-align:center;cursor:pointer;
    }

    .modal{
      position:fixed;top:0;left:0;width:100%;height:100%;
      background:rgba(0,0,0,.6);display:none;
      align-items:center;justify-content:center;z-index:1000;
    }

    .modal-content{
      background:#fff;padding:20px;border-radius:14px;
      max-width:650px;width:90%;
    }

    .modal-content img{width:100%;border-radius:10px;margin-bottom:12px;}
    .modal-close{float:right;cursor:pointer;font-weight:700;color:#999;}

    @media(max-width:900px){.berita-grid{grid-template-columns:1fr 1fr}}
    @media(max-width:600px){.berita-grid{grid-template-columns:1fr}}
  </style>
</head>
<body>

<header class="nav-wrap">
  <div class="container nav">
    <a class="brand" href="index.html">
      <img src="assets/img/logo-lazisnu.png" class="logo">
      <span class="brand-text">UPZISNU PANDANWANGI 01</span>
    </a>

    <nav class="nav-links" id="navLinks">
      <a href="index.html">Beranda</a>
      <a href="tentang.html">Tentang</a>
      <a href="program.html">Program</a>
      <a href="donasi.html">Donasi</a>
      <a href="laporan.html">Laporan</a>
      <a href="berita.html" class="active">Berita</a>
      <a href="kontak.html">Kontak</a>
    </nav>

    <div class="nav-cta">
      <button class="btn btn-donate" id="donateBtn">DONASI SEKARANG</button>
      <button class="nav-toggle" id="navToggle">â˜°</button>
    </div>
  </div>
</header>

<div class="berita-wrap">
  <div class="section-title">Berita & Kegiatan</div>
  <div class="section-sub">
    Dokumentasi kegiatan penyaluran dan program LAZISNU Pandanwangi 01.
  </div>

  <!-- BERITA DARI CMS (AUTO) -->
  <div class="berita-grid" id="list-berita"></div>

  <!-- BERITA MANUAL (FALLBACK) -->
  <div class="berita-grid">
    
  </div>
</div>

<footer class="site-footer">
  <div class="container footer-grid">
    <div class="footer-col">
      <img src="assets/img/logo-lazisnu.png" class="footer-logo">
      <p>LAZISNU Pandanwangi 01 adalah lembaga amil zakat yang mengelola Zakat, Infak, dan Sedekah secara amanah.</p>
    </div>
    <div class="footer-col">
      <h4>Menu</h4>
      <ul class="footer-links">
        <li><a href="index.html">Beranda</a></li>
        <li><a href="tentang.html">Tentang</a></li>
        <li><a href="program.html">Program</a></li>
        <li><a href="donasi.html">Donasi</a></li>
        <li><a href="laporan.html">Laporan</a></li>
        <li><a href="berita.html">Berita</a></li>
        <li><a href="kontak.html">Kontak</a></li>
      </ul>
    </div>
    <div class="footer-col">
      <h4>Kontak</h4>
      <p>Jl. Wachid Hasyim<br>Pandanwangi 01, Tempeh, Lumajang</p>
      <p>WhatsApp: 0851-3473-9466</p>
      <p>Email: lazisn393@gmail.com</p>
    </div>
  </div>
  <div class="footer-bottom">
    <small>Â© <span id="year"></span> LAZISNU Pandanwangi 01</small>
  </div>
</footer>

<script src="js/script.js"></script>

<script>
async function loadBerita() {
  const repoUrl = "https://api.github.com/repos/alfaragatak87/lazisnu/contents/admin-data/berita";

  try {
    const res = await fetch(repoUrl);
    const files = await res.json();

    let html = "";

    for (let file of files.reverse()) {
      const fileRes = await fetch(file.download_url);
      const text = await fileRes.text();

      // ðŸ”¥ Ambil bagian YAML (di antara ---)
      const yamlMatch = text.match(/---([\s\S]*?)---/);
      const yaml = yamlMatch ? yamlMatch[1] : "";

      const titleMatch = yaml.match(/title:\s*(.*)/);
      const dateMatch = yaml.match(/date:\s*(.*)/);
      const imageMatch = yaml.match(/image:\s*(.*)/);

      const title = titleMatch ? titleMatch[1].trim() : "Tanpa Judul";
      const date = dateMatch ? dateMatch[1].trim() : "";
      let image = imageMatch ? imageMatch[1].trim() : "";

      // Bersihkan tanda kutip kalau ada
      image = image.replace(/"/g, "");

      // ðŸ”¥ Fix URL gambar biar tidak error
      if (image.startsWith("/")) {
        image = window.location.origin + image;
      }

      const body = text.split('---')[2] || "";

      const modalId = "modal-" + Math.random().toString(36).substring(2, 9);

      html += `
        <div class="berita-card">
          <img src="${image}" alt="${title}">
          <div class="berita-body">
            <div class="berita-date">${new Date(date).toLocaleDateString("id-ID")}</div>
            <h3>${title}</h3>
            <p>${body.substring(0,120)}...</p>
            <div class="btn-baca" onclick="openModal('${modalId}')">
              Baca Selengkapnya
            </div>
          </div>
        </div>

        <div class="modal" id="${modalId}">
          <div class="modal-content">
            <span class="modal-close" onclick="closeModal('${modalId}')">âœ–</span>
            <h2>${title}</h2>
            <img src="${image}">
            <p>${body}</p>
          </div>
        </div>
      `;
    }

    document.getElementById("list-berita").innerHTML = html;

  } catch (error) {
    console.error("Gagal load berita:", error);
  }
}

loadBerita();

function openModal(id){
  document.getElementById(id).style.display="flex";
}

function closeModal(id){
  document.getElementById(id).style.display="none";
}
</script>

</body>
</html>
